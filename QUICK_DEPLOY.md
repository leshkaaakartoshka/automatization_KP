# üöÄ –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π CPQ System –Ω–∞ Ubuntu 24.04

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

- Ubuntu 24.04 LTS
- IP –∞–¥—Ä–µ—Å: 193.32.179.66
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã: 80 (HTTP)

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –Ω–∞ Ubuntu 24.04

```bash
# –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker $USER

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker Compose
sudo apt install docker-compose-plugin -y

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º—Å—è (–∏–ª–∏ –≤—ã—Ö–æ–¥–∏–º –∏ –∑–∞—Ö–æ–¥–∏–º –∑–∞–Ω–æ–≤–æ)
sudo reboot
```

### 2. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –°–∫–∞—á–∏–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)
git clone <–≤–∞—à-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π> cpq-system
cd cpq-system

# –ò–ª–∏ –∫–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ scp/rsync
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ö–æ–ø–∏—Ä—É–µ–º —à–∞–±–ª–æ–Ω
cp env.production.example .env

# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nano .env
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤ .env:**
```bash
TG_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
TG_MANAGER_CHAT_ID=–≤–∞—à_chat_id_–æ—Ç_userinfobot
HASH_SALT=—Å–ª—É—á–∞–π–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞_32_—Å–∏–º–≤–æ–ª–∞
```

### 4. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
# –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p backend/pdf logs

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º—É
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
docker-compose ps
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
curl http://193.32.179.66

# –ü—Ä–æ–≤–µ—Ä—è–µ–º API
curl http://193.32.179.66/api/health

# –ü—Ä–æ–≤–µ—Ä—è–µ–º API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
curl http://193.32.179.66/api/docs
```

## üåê –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:

- **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: http://193.32.179.66
- **API**: http://193.32.179.66/api
- **API Docs**: http://193.32.179.66/api/docs
- **Health Check**: http://193.32.179.66/health

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f

# –¢–æ–ª—å–∫–æ –±—ç–∫–µ–Ω–¥
docker-compose logs -f backend

# –¢–æ–ª—å–∫–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
docker-compose logs -f frontend
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
docker-compose down
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
docker-compose restart
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
docker-compose down

# –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–¥ (git pull –∏–ª–∏ –∑–∞–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤)
git pull

# –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º
docker-compose up -d --build
```

## üßπ –û—á–∏—Å—Ç–∫–∞ PDF —Ñ–∞–π–ª–æ–≤

PDF —Ñ–∞–π–ª—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏:

```bash
# –ó–∞–ø—É—Å–∫ –æ—á–∏—Å—Ç–∫–∏ –≤—Ä—É—á–Ω—É—é
./cleanup-pdfs.sh

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00)
crontab -e
# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
0 2 * * * /path/to/cpq-system/cleanup-pdfs.sh
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Address already in use"
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç 80
sudo netstat -tulpn | grep :80

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º nginx/apache –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω
sudo systemctl stop nginx
sudo systemctl stop apache2
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied"
```bash
# –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
sudo chown -R $USER:$USER backend/pdf/
chmod +x cleanup-pdfs.sh
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Container not starting"
```bash
# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
docker-compose logs backend
docker-compose logs frontend

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker-compose config
```

### –ü—Ä–æ–±–ª–µ–º–∞: "CORS error"
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤ .env –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π BASE_URL
grep BASE_URL .env

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: BASE_URL=http://193.32.179.66
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
```bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
curl -f http://193.32.179.66/health && echo "‚úÖ Frontend OK" || echo "‚ùå Frontend ERROR"
curl -f http://193.32.179.66/api/health && echo "‚úÖ Backend OK" || echo "‚ùå Backend ERROR"
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```bash
# –†–∞–∑–º–µ—Ä PDF –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
du -sh backend/pdf/

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ PDF —Ñ–∞–π–ª–æ–≤
find backend/pdf/ -name "*.pdf" | wc -l

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
docker system df
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞

1. **–ò–∑–º–µ–Ω–∏—Ç–µ HASH_SALT** –Ω–∞ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall** (—Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç 80)
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** —Å–∏—Å—Ç–µ–º—É
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –ª–æ–≥–æ–≤
5. **–î–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø—ã** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall
```bash
# –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ HTTP
sudo ufw allow 80/tcp
sudo ufw deny 22/tcp  # –ó–∞–∫—Ä—ã–≤–∞–µ–º SSH –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω
sudo ufw enable
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: `docker-compose config`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `cat .env`

---

**üéâ –ì–æ—Ç–æ–≤–æ! –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ CPQ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!**
